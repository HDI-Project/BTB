

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Selection &mdash; BTB 0.3.12.dev1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/dai-logo-white.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="BTBSession" href="03_Session.html" />
    <link rel="prev" title="Tuning" href="01_Tuning.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> BTB
          

          
            
            <img src="../_static/dai-logo-white-200.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.3.12.dev1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#stable-release">Stable Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#from-source">From source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="00_Quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="00_Quickstart.html#Prepare-a-scoring-function">Prepare a scoring function</a></li>
<li class="toctree-l2"><a class="reference internal" href="00_Quickstart.html#Define-the-tunable-hyperparameters">Define the tunable hyperparameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="00_Quickstart.html#Start-the-searching-process">Start the searching process</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">User Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01_Tuning.html">Tuning</a><ul>
<li class="toctree-l2"><a class="reference internal" href="01_Tuning.html#Defining-a-Tuning-Problem">Defining a Tuning Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="01_Tuning.html#What-is-a-Hyperparameter?">What is a Hyperparameter?</a></li>
<li class="toctree-l2"><a class="reference internal" href="01_Tuning.html#Creating-a-HyperParam">Creating a HyperParam</a><ul>
<li class="toctree-l3"><a class="reference internal" href="01_Tuning.html#BooleanHyperParam">BooleanHyperParam</a></li>
<li class="toctree-l3"><a class="reference internal" href="01_Tuning.html#CategoricalHyperParam">CategoricalHyperParam</a></li>
<li class="toctree-l3"><a class="reference internal" href="01_Tuning.html#FloatHyperParam">FloatHyperParam</a></li>
<li class="toctree-l3"><a class="reference internal" href="01_Tuning.html#IntHyperParam">IntHyperParam</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="01_Tuning.html#What-is-Tunable?">What is Tunable?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="01_Tuning.html#Creating-a-Tunable">Creating a Tunable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="01_Tuning.html#Using-HyperParam-instances">Using HyperParam instances</a></li>
<li class="toctree-l4"><a class="reference internal" href="01_Tuning.html#Using-a-dict-representation">Using a dict representation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="01_Tuning.html#What-is-a-Tuner?">What is a Tuner?</a></li>
<li class="toctree-l2"><a class="reference internal" href="01_Tuning.html#Using-a-Tuner">Using a Tuner</a><ul>
<li class="toctree-l3"><a class="reference internal" href="01_Tuning.html#Creating-a-Tuner">Creating a Tuner</a></li>
<li class="toctree-l3"><a class="reference internal" href="01_Tuning.html#Propose">Propose</a></li>
<li class="toctree-l3"><a class="reference internal" href="01_Tuning.html#Record">Record</a></li>
<li class="toctree-l3"><a class="reference internal" href="01_Tuning.html#Tuning-loop-example">Tuning loop example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="01_Tuning.html#Implemented-tuners">Implemented tuners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="01_Tuning.html#Leaderboard">Leaderboard</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Selection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#What-is-a-Selection-problem?">What is a Selection problem?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#What-is-a-Selector-?">What is a Selector ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Using-a-Selector">Using a Selector</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Creating-a-Selector">Creating a Selector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Select">Select</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Selection-loop-example">Selection loop example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="03_Session.html">BTBSession</a><ul>
<li class="toctree-l2"><a class="reference internal" href="03_Session.html#What-is-BTBSession">What is BTBSession</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_Session.html#Creating-a-BTBSession">Creating a BTBSession</a><ul>
<li class="toctree-l3"><a class="reference internal" href="03_Session.html#Prepare-a-scoring-function">Prepare a scoring function</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_Session.html#Define-the-tunable-hyperparameters">Define the tunable hyperparameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_Session.html#Create-BTBSession-instance">Create BTBSession instance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="03_Session.html#Using-BTBSession">Using BTBSession</a><ul>
<li class="toctree-l3"><a class="reference internal" href="03_Session.html#Run">Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_Session.html#Exploring-the-result">Exploring the result</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_Session.html#Resume-session">Resume session</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="03_Session.html#Fitting-the-best-solution">Fitting the best solution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../benchmark.html">Benchmarking BTB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../benchmark.html#the-benchmarking-process">The Benchmarking process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../benchmark.html#challenges">Challenges</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../benchmark.html#machine-learning-challenges">Machine Learning Challenges</a></li>
<li class="toctree-l4"><a class="reference internal" href="../benchmark.html#mathematical-optimization-challenges">Mathematical Optimization Challenges</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../benchmark.html#tuning-functions">Tuning Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../benchmark.html#tuning-functions-under-comparison">Tuning functions under comparison</a></li>
<li class="toctree-l4"><a class="reference internal" href="../benchmark.html#to-introduce-a-new-tuning-function">To introduce a new Tuning Function:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark.html#running-the-benchmarking">Running the Benchmarking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../benchmark.html#install">Install</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../benchmark.html#system-requierements">System Requierements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../benchmark.html#python-installation">Python installation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../benchmark.html#runnig-the-benchmarking-using-python">Runnig the Benchmarking using python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../benchmark.html#benchmark-arguments">Benchmark Arguments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../benchmark.html#tuners">Tuners</a></li>
<li class="toctree-l4"><a class="reference internal" href="../benchmark.html#id1">Challenges</a></li>
<li class="toctree-l4"><a class="reference internal" href="../benchmark.html#iterations">Iterations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../benchmark.html#storing-the-results">Storing the results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark.html#our-latest-results">Our latest Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark.html#kubernetes">Kubernetes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../benchmark.html#credits">Credits</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../kubernetes.html">Kubernetes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../kubernetes.html#requirements">Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kubernetes.html#kubernetes-cluster">Kubernetes Cluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kubernetes.html#admin-access">Admin Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kubernetes.html#dask-function">Dask Function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kubernetes.html#benchmark-configuration">Benchmark Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kubernetes.html#configuration-format">Configuration Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../kubernetes.html#run">run</a></li>
<li class="toctree-l4"><a class="reference internal" href="../kubernetes.html#dask-cluster">dask_cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../kubernetes.html#output">output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../kubernetes.html#configuration-examples">Configuration Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kubernetes.html#run-a-function-on-kubernetes">Run a function on Kubernetes.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../kubernetes.html#usage-example">Usage Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../kubernetes.html#results">Results</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/btb.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/btb.selection.html">btb.selection package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.selection.best.html">btb.selection.best module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.selection.custom_selector.html">btb.selection.custom_selector module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.selection.hierarchical.html">btb.selection.hierarchical module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.selection.pure.html">btb.selection.pure module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.selection.recent.html">btb.selection.recent module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.selection.selector.html">btb.selection.selector module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.selection.ucb1.html">btb.selection.ucb1 module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.selection.uniform.html">btb.selection.uniform module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/btb.tuning.html">btb.tuning package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.tuning.acquisition.html">btb.tuning.acquisition package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.acquisition.base.html">btb.tuning.acquisition.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.acquisition.expected_improvement.html">btb.tuning.acquisition.expected_improvement module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.acquisition.predicted_score.html">btb.tuning.acquisition.predicted_score module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.tuning.hyperparams.html">btb.tuning.hyperparams package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.hyperparams.base.html">btb.tuning.hyperparams.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.hyperparams.boolean.html">btb.tuning.hyperparams.boolean module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.hyperparams.categorical.html">btb.tuning.hyperparams.categorical module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.hyperparams.numerical.html">btb.tuning.hyperparams.numerical module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.tuning.metamodels.html">btb.tuning.metamodels package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.metamodels.base.html">btb.tuning.metamodels.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.metamodels.gaussian_process.html">btb.tuning.metamodels.gaussian_process module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.tuning.tuners.html">btb.tuning.tuners package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.tuners.base.html">btb.tuning.tuners.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.tuners.gaussian_process.html">btb.tuning.tuners.gaussian_process module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/btb.tuning.tuners.uniform.html">btb.tuning.tuners.uniform module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/btb.tuning.tunable.html">btb.tuning.tunable module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/btb.session.html">btb.session module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Credits</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BTB</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Selection</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/HDI-Project/BTB/blob/master/docs/tutorials/02_Selection.ipynb" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Selection">
<h1>Selection<a class="headerlink" href="#Selection" title="Permalink to this headline">¶</a></h1>
<div class="section" id="What-is-a-Selection-problem?">
<h2>What is a Selection problem?<a class="headerlink" href="#What-is-a-Selection-problem?" title="Permalink to this headline">¶</a></h2>
<p>There are some scenarios where we have a single goal which can be solved in multiple ways. Each one of these solutions represents an individual Tuning Problem, and we have no prior knowledge about how good each solution will be once it is tuned.</p>
<p>In these scenarios, one possibility would be to solve the problem using brute-force, which means tuning each solution candidate and then using the one that got the best score.</p>
<p>However, in most cases we will not have the time or resources to tune all the possible solutions beforehand, and we will want to solve what is called a Multi-armed Bandit Problem: start tuning all the solutions at once and optimally select which solutions to keep tuning depending on the scores that they obtain during the process.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Multi-armed_bandit">Multi-Armed Bandit</a> instead is a solution that tries to find the best candidate spending the minimum trials possible. This process is less time consuming than the previous one as is based on the scores that the <code class="docutils literal notranslate"><span class="pre">candidates</span></code> are obtaining during the process.</p>
</div>
<div class="section" id="What-is-a-Selector-?">
<h2>What is a Selector ?<a class="headerlink" href="#What-is-a-Selector-?" title="Permalink to this headline">¶</a></h2>
<p>In BTB, the selection problem is solved using the Selector family of classes.</p>
<p>These classes have to be used in combination with multiple tuning problems, represented as multiple Tuner instances, each one of them created using a different Tunable, and the corresponding functions or Machine Learning algorithms.</p>
<p>Currently, BTB implements the following Selectors:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">UCB1</span></code>: uses Upper Confidence Bound 1 algorithm (UCB1) for bandit selection.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BestKReward</span></code>: computes the average reward from the past scores by using only the highest k scores.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BestKVelocity</span></code>: compute the velocity of the best scores. The velocities are the <span class="math notranslate nohighlight">\(k\)</span> distances between the <span class="math notranslate nohighlight">\(k+1\)</span> best scores.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PureBestKVelocity</span></code>: returns the choice with the best best-K velocity.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RecentKReward</span></code>: recent <span class="math notranslate nohighlight">\(k\)</span> reward selector, where <span class="math notranslate nohighlight">\(k\)</span> is the number of best scores to consider.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RecentKVelocity</span></code>: compute the velocity of the <span class="math notranslate nohighlight">\(k+1\)</span> most recent scores.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Uniform</span></code>: selects a choice uniformly at random.</p></li>
</ul>
</div>
<div class="section" id="Using-a-Selector">
<h2>Using a Selector<a class="headerlink" href="#Using-a-Selector" title="Permalink to this headline">¶</a></h2>
<p>The selectors are intended to be used in combination with Tuners by using their <code class="docutils literal notranslate"><span class="pre">select</span></code> method.</p>
<div class="section" id="Creating-a-Selector">
<h3>Creating a Selector<a class="headerlink" href="#Creating-a-Selector" title="Permalink to this headline">¶</a></h3>
<p>In order to create a selector you need to define a list of candidates and then pass it as a positional argument.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">btb.selection</span> <span class="kn">import</span> <span class="n">UCB1</span>

<span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">]</span>

<span class="n">selector</span> <span class="o">=</span> <span class="n">UCB1</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Select">
<h3>Select<a class="headerlink" href="#Select" title="Permalink to this headline">¶</a></h3>
<p>Once we have evaluated some tuners and obtained scores, we have to create a dictionary with the candidate as a key and a list of scores that this has obtained.</p>
<p>This dictionry has to be passed to the <code class="docutils literal notranslate"><span class="pre">select</span></code> method which will return the name of the next tuner to use.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tuner_scores</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;foo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
    <span class="s1">&#39;bar&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">next_choice</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">tuner_scores</span><span class="p">)</span>
<span class="n">next_choice</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;foo&#39;
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Selection-loop-example">
<h2>Selection loop example<a class="headerlink" href="#Selection-loop-example" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of how to use Selectors and Tuners together to solve a Machine Learning problem with two candidate algorithms.</p>
<p>For this example we are going to use the <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_iris.html">Iris dataset</a> and tune two estimators: - <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html">DecisionTreeClassifier</a> - <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html">SGDClassifier</a></p>
<p>Next, we will load the dataset and split it in two partitions, train and test, which we will use later on to evaluate the performance of our machine learning model:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># load the dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>

<span class="c1"># split the dataset</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we will create a dictionary of our “candidates” with a given name as a key, this will help us when selecting to pick the model:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>

<span class="n">candidates</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;DTC&#39;</span><span class="p">:</span> <span class="n">DecisionTreeClassifier</span><span class="p">,</span>
    <span class="s1">&#39;SGDC&#39;</span><span class="p">:</span> <span class="n">SGDClassifier</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>In the following step we will create the hyperpams for each one of our models:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">btb.tuning</span> <span class="kn">import</span> <span class="n">hyperparams</span> <span class="k">as</span> <span class="n">hp</span>

<span class="n">dtc_hyperparams</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">IntHyperParam</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span>
    <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">FloatHyperParam</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">sgdc_hyperparams</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;max_iter&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">IntHyperParam</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;tol&#39;</span><span class="p">:</span> <span class="n">hp</span><span class="o">.</span><span class="n">FloatHyperParam</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Now let’s create the tunable and tuner for each one of them, and store those in a dictionary like we did with the models, in order to be able to access them when selecting:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">btb.tuning</span> <span class="kn">import</span> <span class="n">GPTuner</span><span class="p">,</span> <span class="n">Tunable</span>

<span class="c1"># Creating the tunables for our tuners</span>
<span class="n">dtc_tunable</span> <span class="o">=</span> <span class="n">Tunable</span><span class="p">(</span><span class="n">dtc_hyperparams</span><span class="p">)</span>
<span class="n">sgdc_tunable</span> <span class="o">=</span> <span class="n">Tunable</span><span class="p">(</span><span class="n">sgdc_hyperparams</span><span class="p">)</span>

<span class="n">tuners</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;DTC&#39;</span><span class="p">:</span> <span class="n">GPTuner</span><span class="p">(</span><span class="n">dtc_tunable</span><span class="p">),</span>
    <span class="s1">&#39;SGDC&#39;</span><span class="p">:</span> <span class="n">GPTuner</span><span class="p">(</span><span class="n">sgdc_tunable</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>Now, we can create a selector with the candidates “DTC” and “SGDC” as our selector will return one of those values, and we can access the models / tuners using those keys:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">btb.selection</span> <span class="kn">import</span> <span class="n">UCB1</span>

<span class="n">selector</span> <span class="o">=</span> <span class="n">UCB1</span><span class="p">([</span><span class="s1">&#39;DTC&#39;</span><span class="p">,</span> <span class="s1">&#39;SGDC&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>Finally, we will proceed to loop with the following steps:</p>
<ol class="arabic simple">
<li><p>select a candidate.</p></li>
<li><p>propose a set of parameters.</p></li>
<li><p>fit the model with those parameters.</p></li>
<li><p>score the model.</p></li>
<li><p>record the parameters and the score that we obtained.</p></li>
<li><p>evaluate if its the best score found so far.</p></li>
</ol>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">best_score</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">candidate</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">select</span><span class="p">({</span>
        <span class="s1">&#39;DTC&#39;</span><span class="p">:</span> <span class="n">tuners</span><span class="p">[</span><span class="s1">&#39;DTC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">scores</span><span class="p">,</span>
        <span class="s1">&#39;SGDC&#39;</span><span class="p">:</span> <span class="n">tuners</span><span class="p">[</span><span class="s1">&#39;SGDC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">scores</span>
    <span class="p">})</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">tuners</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span><span class="o">.</span><span class="n">propose</span><span class="p">()</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="n">candidate</span><span class="p">](</span><span class="o">**</span><span class="n">parameters</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">tuners</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">best_score</span><span class="p">:</span>
        <span class="n">best_score</span> <span class="o">=</span> <span class="n">score</span>
        <span class="n">best_model</span> <span class="o">=</span> <span class="n">candidate</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">parameters</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best score: &#39;</span><span class="p">,</span> <span class="n">best_score</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best model: &#39;</span><span class="p">,</span> <span class="n">best_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Best parameters: &#39;</span><span class="p">,</span> <span class="n">best_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Best score:  0.9777777777777777
Best model:  DTC
Best parameters:  {&#39;max_depth&#39;: 26, &#39;min_samples_split&#39;: 0.2978860831816922}
</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="03_Session.html" class="btn btn-neutral float-right" title="BTBSession" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="01_Tuning.html" class="btn btn-neutral float-left" title="Tuning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, MIT Data To AI Lab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>